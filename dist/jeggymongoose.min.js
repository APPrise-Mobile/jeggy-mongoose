function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _inherits(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}var _createClass=function(){function e(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(o,t,n){return t&&e(o.prototype,t),n&&e(o,n),o}}(),_get=function(e,o,t){for(var n=!0;n;){var r=e,i=o,u=t;l=s=c=void 0,n=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,i);if(void 0!==l){if("value"in l)return l.value;var c=l.get;return void 0===c?void 0:c.call(u)}var s=Object.getPrototypeOf(r);if(null===s)return void 0;e=s,o=i,t=u,n=!0}};!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("jeggy"),require("mongoose-mob"),require("mongoose-merge-plugin"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","jeggy","mongoose-mob","mongoose-merge-plugin","lodash"],o):o(e.jeggymongoose={},e.jeggy,e.mongooseMob,e.merge,e._)}(this,function(e,o,t,n,r){"use strict";t="default"in t?t["default"]:t,n="default"in n?n["default"]:n,r="default"in r?r["default"]:r;var i=function(e){function o(e,t){if(_classCallCheck(this,o),_get(Object.getPrototypeOf(o.prototype),"constructor",this).call(this,e),!t)throw new Error("a MongooseCollection must be intiialized with a mongoose model");this.mongooseModel=t}return _inherits(o,e),_createClass(o,[{key:"find",value:function(e,o){return this.mongooseModel.find(e,o).exec()}},{key:"findOne",value:function(e,o){return this.mongooseModel.findOne(e,o).exec()}},{key:"findById",value:function(e,o){return this.mongooseModel.findById(e,o).exec()}},{key:"create",value:function(e){return this.mongooseModel.create(e)}},{key:"insertMany",value:function(e){var o=this;return new Promise(function(t,n){o.mongooseModel.collection.insertMany(e,{},function(e,o){return e?n(e):void t(o.ops)})})}},{key:"removeWhere",value:function(e){return this.mongooseModel.remove(e)}},{key:"remove",value:function(e){return this.mongooseModel.findById(e._id).exec().then(function(o){if(!o)throw new Error("trying to remove doc that does not exist id:"+e._id);return o.remove()})}},{key:"update",value:function(e){return this.mongooseModel.findById(e._id).exec().then(function(o){if(!o)throw new Error("trying to update doc that does not exist id:"+e._id);return o.merge(e),o.save()})}}]),o}(o.Collection);e.MongooseCollection=i;var u=function(e,o){return new Promise(function(t,n){e.populate(o,function(o){return o?n(o):void t(e)})})},l=function(e){function o(e){_classCallCheck(this,o),_get(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),r.isString(e)&&(e=t.getConnection(e)),e.base.plugin(n),this.mongooseConnection=e,this.collections={}}return _inherits(o,e),_createClass(o,[{key:"addCollection",value:function(e,o){var n=void 0;if(e instanceof i)n=e,e=n.name;else{if(!r.isString(e)||r.isEmpty(e))throw new Error("must provide a name when adding a collection");var u=t.getModel(this.mongooseConnection,e,o);n=new i(e,u)}return this.collections[e]=n,n}},{key:"getCollection",value:function(e){if(!this.collections[e])throw new Error("unknown collection: "+e);return this.collections[e]}},{key:"getCollections",value:function(){return this.collections}},{key:"populate",value:function(e,o){if(!e)throw new Error("tried to populate a null value");r.isArray(e)||(e=[e]);var t=r.map(e,function(e){return u(e,o)});return Promise.all(t).then(function(){return e})}}]),o}(o.Adapter);e.MongooseAdapter=l});
//# sourceMappingURL=jeggymongoose.min.js.map