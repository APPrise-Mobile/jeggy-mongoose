function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _inherits(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(e.__proto__=o)}var _createClass=function(){function e(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(o,t,n){return t&&e(o.prototype,t),n&&e(o,n),o}}(),_get=function(e,o,t){for(var n=!0;n;){var r=e,i=o,u=t;l=a=c=void 0,n=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,i);if(void 0!==l){if("value"in l)return l.value;var c=l.get;return void 0===c?void 0:c.call(u)}var a=Object.getPrototypeOf(r);if(null===a)return void 0;e=a,o=i,t=u,n=!0}};!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("jeggy"),require("lodash"),require("mongoose-mob")):"function"==typeof define&&define.amd?define(["exports","jeggy","lodash","mongoose-mob"],o):o(e.jeggymongoose={},e.jeggy,e._,e.mongooseMob)}(this,function(e,o,t,n){"use strict";t="default"in t?t["default"]:t,n="default"in n?n["default"]:n;var r=function(e){function o(e,t){if(_classCallCheck(this,o),_get(Object.getPrototypeOf(o.prototype),"constructor",this).call(this,e),!t)throw new Error("a MongooseCollection must be intiialized with a mongoose model");this.mongooseModel=t}return _inherits(o,e),_createClass(o,[{key:"find",value:function(e,o){return this.mongooseModel.find(e,o).exec()}},{key:"findOne",value:function(e,o){return this.mongooseModel.findOne(e,o).exec()}},{key:"findById",value:function(e,o){return this.mongooseModel.findById(e,o).exec()}},{key:"create",value:function(e){return this.mongooseModel.create(e)}},{key:"removeWhere",value:function(e){return this.mongooseModel.remove(e)}},{key:"remove",value:function(e){return this.mongooseModel.findById(e._id).exec().then(function(o){if(!o)throw new Error("trying to remove doc that does not exist id:"+e._id);return o.remove()})}},{key:"update",value:function(e){return this.mongooseModel.findById(e._id).exec().then(function(o){if(!o)throw new Error("trying to update doc that does not exist id:"+e._id);return e=t.omit(e,"_id"),e=t.omit(e,"__v"),o=t.merge(o.toObject(),e),t.forEach(t.keys(e),function(e){o.markModified(e)}),o.save()})}}]),o}(o.Collection);e.MongooseCollection=r;var i=function(e,o){return new Promise(function(t,n){e.populate(o,function(o){return o?n(o):void t(e)})})},u=function(e){function o(e){_classCallCheck(this,o),_get(Object.getPrototypeOf(o.prototype),"constructor",this).call(this),t.isString(e)&&(e=n.getConnection(e)),this.mongooseConnection=e,this.collections={}}return _inherits(o,e),_createClass(o,[{key:"addCollection",value:function(e,o){var i=void 0;if(e instanceof r)i=e,e=i.name;else{if(!t.isString(e)||t.isEmpty(e))throw new Error("must provide a name when adding a collection");var u=n.getModel(this.mongooseConnection,e,o);i=new r(e,u)}return this.collections[e]=i,i}},{key:"getCollection",value:function(e){if(!this.collections[e])throw new Error("unknown collection: "+e);return this.collections[e]}},{key:"getCollections",value:function(){return this.collections}},{key:"populate",value:function(e,o){if(!e)throw new Error("tried to populate a null value");t.isArray(e)||(e=[e]);var n=t.map(e,function(e){return i(e,o)});return Promise.all(n).then(function(){return e})}}]),o}(o.Adapter);e.MongooseAdapter=u});
//# sourceMappingURL=jeggymongoose.min.js.map